<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Ffmpeg on もざぶれなるままに</title>
        <link>https://mitz17.com/tags/ffmpeg/</link>
        <description>Recent content in Ffmpeg on もざぶれなるままに</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>ja-jp</language>
        <lastBuildDate>Mon, 02 Mar 2026 00:00:00 +0900</lastBuildDate><atom:link href="https://mitz17.com/tags/ffmpeg/index.xml" rel="self" type="application/rss+xml" /><item>
            <title>mp3-normalizer 開発ログ</title>
            <link>https://mitz17.com/blog/mp3-normalizer-devlog/</link>
            <pubDate>Mon, 02 Mar 2026 00:00:00 +0900</pubDate>
            <guid>https://mitz17.com/blog/mp3-normalizer-devlog/</guid>
            <description>&lt;p&gt;GitHub: &lt;a class=&#34;link&#34; href=&#34;https://github.com/mitz17/mp3-normalizer&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;&#xD;&#xA;    &gt;mitz17/mp3-normalizer&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;背景&#34;&gt;背景&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;10 年くらい前に作った mp3 をふと再生したら「え、なんか音ちいさくない？」となりました。コピペの荒波に飲まれてビットレートが劣化したのかと疑ったものの、音質自体は悪くなっていない。つまりファイルそのものはまだ元気だけれど、音声レベルが不揃いなままだと今後も安心して使えない──そう実感したのがこのツールを作るきっかけでした。&lt;/p&gt;&#xA;&lt;h2 id=&#34;対象読者&#34;&gt;対象読者&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;古い mp3 アーカイブを今も大切にしていて、音量だけさっと手直ししたい人&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ffmpeg&lt;/code&gt; の呪文を暗記していないけど、まとめて正規化したい人&lt;/li&gt;&#xA;&lt;li&gt;エンジニアと非エンジニアが同じツールで音源を管理したいチーム&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;前提python-と-mp3&#34;&gt;前提（Python と mp3）&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Python 3.11 以上 + ffmpeg 6.x が動作する環境が存在していること。ffmpeg の導入は &lt;a class=&#34;link&#34; href=&#34;https://qiita.com/Tadataka_Takahashi/items/9dcb0cf308db6f5dc31b&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;&#xD;&#xA;    &gt;この Qiita 記事&lt;/a&gt; を参考にして OS ごとの手順を順番にたどれば OK。&lt;/li&gt;&#xA;&lt;li&gt;正規化したい &lt;code&gt;.mp3&lt;/code&gt; をフォルダごと用意しておき、WAV などは事前に変換しておく。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;環境&#34;&gt;環境&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;OS: Windows 11（PowerShell）で動作確認済み&lt;/li&gt;&#xA;&lt;li&gt;Python: 3.11.7（&lt;code&gt;python -m venv .venv&lt;/code&gt; 推奨）&lt;/li&gt;&#xA;&lt;li&gt;ffmpeg: 6.1 系（&lt;code&gt;ffmpeg -version&lt;/code&gt; で確認）&lt;/li&gt;&#xA;&lt;li&gt;GUI: Tkinter + ttk を素朴に使用&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;ゴール&#34;&gt;ゴール&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;OS を問わず、誰でも同じ LUFS 正規化フローを踏める&lt;/li&gt;&#xA;&lt;li&gt;GUI でも CLI でも結果が揃い、履歴とログで説明責任を果たせる&lt;/li&gt;&#xA;&lt;li&gt;「入力フォルダを置き換えたら音が揃う」を日常運用に落とし込む&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;プロジェクトの概要&#34;&gt;プロジェクトの概要&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Python 3.11 + ffmpeg 6.x の軽量構成&lt;/li&gt;&#xA;&lt;li&gt;GUI/CLI 共通のエンジン (&lt;code&gt;processor.py&lt;/code&gt;) と再利用しやすいユーティリティ (&lt;code&gt;utils.py&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;processed_history.json&lt;/code&gt; で二重実行を抑止し、&lt;code&gt;mp3_normalizer.log&lt;/code&gt; で証跡を残す&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;loudnorm&lt;/code&gt; 1pass を使い、-14 LUFS / -1 dBFS をデフォルトターゲットに設定&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;どんな課題を解いているのか&#34;&gt;どんな課題を解いているのか&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;古いファイルでも音質は十分なので、音量だけ揃えればまだまだ使える&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ffmpeg&lt;/code&gt; のコマンドを忘れても GUI のプルダウンで完結する&lt;/li&gt;&#xA;&lt;li&gt;いつどのファイルを処理したかがログで追えるので、再録や差し戻しが怖くない&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;セットアップの流れ&#34;&gt;セットアップの流れ&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;git clone https://github.com/mitz17/mp3-normalizer&lt;/code&gt; でソースを取得&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;python -m venv .venv &amp;amp;&amp;amp; source .venv/bin/activate&lt;/code&gt;（Windows は &lt;code&gt;Activate.ps1&lt;/code&gt;）&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;pip install -r requirements.txt&lt;/code&gt; で依存をインストール&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;python main.py&lt;/code&gt; で GUI、&lt;code&gt;python main.py --cli ...&lt;/code&gt; でバッチ処理を実行&lt;/li&gt;&#xA;&lt;li&gt;出力ディレクトリに並んだ MP3 を聴き比べ、ログファイルで値を確認&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 id=&#34;アーキテクチャと実装メモ&#34;&gt;アーキテクチャと実装メモ&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;gui.py&lt;/code&gt; は Tkinter の &lt;code&gt;Frame&lt;/code&gt; を積み上げ、別スレッドで ffmpeg を呼び出し UI フリーズを回避&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;processor.py&lt;/code&gt; は &lt;code&gt;Path.rglob(&#39;*.mp3&#39;)&lt;/code&gt; で対象を探し、衝突しそうなファイルは &lt;code&gt;_1&lt;/code&gt;, &lt;code&gt;_2&lt;/code&gt; とサフィックスを付加&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;-map_metadata 0&lt;/code&gt; で ID3 タグを保ったまま再エンコード&lt;/li&gt;&#xA;&lt;li&gt;ログはプレーンテキストに連ね、LUFS 値や実行コマンドを丸ごと保存&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;gui-の操作感&#34;&gt;GUI の操作感&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;入力・出力ディレクトリを指定すると、対象 MP3 がリストでずらっと表示されます。&lt;/li&gt;&#xA;&lt;li&gt;LUFS と True Peak を入力。迷ったらデフォルト（-14 / -1）のままで OK。&lt;/li&gt;&#xA;&lt;li&gt;再帰チェックや再エンコード強制のトグルで挙動を調整。&lt;/li&gt;&#xA;&lt;li&gt;「実行」を押すと進捗ログが流れ、完了すると結果をスクロールなしで確認できます。&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://mitz17.com/images/mp3-normalizer-gui.png&#34; alt=&#34;mp3-normalizer GUI モックアップ&#34; loading=&#34;lazy&#34; style=&#34;border-radius:16px; box-shadow:0 8px 24px rgba(15,23,42,0.18);&#34;&gt;&lt;/p&gt;&#xD;&#xA;&#xD;&#xA;    &lt;blockquote&gt;&#xD;&#xA;        &lt;p&gt;GUI 全体をざっくり再現したモック。入力/出力、ターゲット LUFS、対象ファイル、ログまで 1 画面で見渡せます。&lt;/p&gt;&#xA;&#xD;&#xA;    &lt;/blockquote&gt;&#xD;&#xA;&lt;h2 id=&#34;cli-の使いどころ&#34;&gt;CLI の使いどころ&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python main.py --cli --input ./old_mp3 --output ./normalized   --lufs -15.0 --true-peak -1.0 --force&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;CI/CD やタスクスケジューラから呼び出すならこちら。終了コード 0/1/2 で「成功/入力エラー/部分失敗」を判定でき、&lt;code&gt;--force&lt;/code&gt; で履歴を無視して再実行することも可能です。&lt;/p&gt;&#xA;&lt;h2 id=&#34;まとめ&#34;&gt;まとめ&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tkinter × ffmpeg という素朴な構成でも、音量正規化の面倒くささはかなり解消できる&lt;/li&gt;&#xA;&lt;li&gt;古い mp3 をまだまだ使いたい人は、ぜひ &lt;code&gt;mp3-normalizer&lt;/code&gt; をクローンして遊んでみてください！&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;</description>
        </item></channel>
</rss>
